#+title: Windows Privileges and Tokens

* windows access tokens
Windows access tokens are a core element of the authentication process on Windows and are created and managed by the local security authority subsystem services (LSASS)

A windows access token is responsible for identify and describing the security context of a process or thread running on a system. Simply put, an access token can be through of as a temporary key akin to a web cookie that provides users with access to a system or network resource without having to provide credentials each time a process is started or a system resource is accessed

Access tokens are generated by the winlogon.exe process every time a user authenticates successfully and includes the identify and privileges of the user account associated

An access token will typically be assigned one of the following security levels

- Impersonate-level tokens are created as a direct result of a non-interactive login on Windows, typically through specific system services or domain logons

- Delegate-level tokens are typically created through an interactive login on windows

* windows privileges
the process of impersonating access tokens to elevate privileges on a system will primarily depend on the privileges assigned to the account that has been exploited to gain initial access as well as the impersonation or delegation tokens available

the following are the privileges that are required for a successful impersonation attack -->
- SeAssignPrimaryToken
- SeCreateToken
- SeImpersonatePrivilege

* the incognito module
incognito is a built-in meterpreter module that was originally a standalone application that allows you to impersonate user tokens after sucessful exploitation

we can use the incognito module to display a list of available tokens that we can impersonate

