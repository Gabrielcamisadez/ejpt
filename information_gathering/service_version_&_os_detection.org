#+title: ğŸ” Service Version & OS Detection
#+author: Gabriel
#+options: num:nil toc:t

* ğŸ› ï¸ Service Version & OS Detection
A detecÃ§Ã£o de serviÃ§os e do Sistema Operacional (SO) Ã© o passo fundamental para identificar a superfÃ­cie de ataque exata e cruzar versÃµes com vulnerabilidades conhecidas (CVEs).

** ğŸ“¡ Escaneamento de VersÃ£o (-sV)
O Nmap interage com as portas abertas enviando /probes/ para determinar o que realmente estÃ¡ rodando, indo alÃ©m do simples mapeamento de portas.

#+begin_src sh
# -sS: TCP SYN Scan (furtivo)
# -sV: Tenta determinar a versÃ£o do serviÃ§o
# -p-: Escaneia todas as 65.535 portas
nmap -sS -sV -p- 10.10.62.4
#+end_src

** ğŸ§ DetecÃ§Ã£o Agressiva de SO (-O)
O Nmap analisa as respostas do stack TCP/IP (como o TTL e o tamanho da janela) para realizar o fingerprinting do sistema operacional.

#+begin_src sh
# -T4: Timing agressivo (ideal para ambientes de lab)
# -O: Ativa a detecÃ§Ã£o de SO
# --osscan-guess: Tenta adivinhar o SO se nÃ£o houver 100% de certeza
nmap -T4 -sS -sV --version-intensity 8 -O --osscan-guess -p- 192.31.214.3
#+end_src


** âš¡ ParÃ¢metros de Intensidade
A opÃ§Ã£o =--version-intensity= define o quÃ£o persistente o Nmap serÃ¡ na identificaÃ§Ã£o.
- *Escala:* 0 a 9.
- *Teoria:* NÃ­veis mais altos testam mais /probes/, sendo mais precisos para serviÃ§os em portas "mentirosas" ou nÃ£o convencionais.

* ğŸ“œ Nmap Scripting Engine (NSE)
O NSE permite que vocÃª use scripts Lua para automatizar tarefas de seguranÃ§a, desde brute-force atÃ© detecÃ§Ã£o de vulnerabilidades crÃ­ticas.

** ğŸ” Buscando Scripts (Foco HTTP)
No seu **Debian/Zsh**, vocÃª pode filtrar os scripts disponÃ­veis no diretÃ³rio padrÃ£o:

#+begin_src sh
# Lista scripts e filtra por palavras-chave (ex: http)
ls -al /usr/share/nmap/scripts | grep -e "http"
#+end_src

** ğŸ“– DocumentaÃ§Ã£o e Help
Sempre valide o comportamento de um script antes de executÃ¡-lo para evitar causar instabilidade no alvo.

#+begin_src sh
# Pega informaÃ§Ãµes e descriÃ§Ã£o de um script especÃ­fico
nmap --script-help=mongodb-databases.nse

# Exemplo de help genÃ©rico
nmap --script-help=banner.nse
#+end_src

** ğŸš€ Exemplo PrÃ¡tico: Vulnerability Scan
#+begin_src sh
# Executa scripts da categoria 'vuln' para checar falhas conhecidas no alvo
nmap --script vuln 172.16.5.35
#+end_src
