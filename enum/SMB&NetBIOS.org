#+TITLE: SMB & NetBIOS Enumeration (Multi-Compliance Perspective)
#+AUTHOR: gabriel
#+DATE: [2026-02-05 qui]
#+OPTIONS: toc:2

* üìÇ Intro to SMB & NetBIOS
SMB e NetBIOS s√£o tecnologias distintas, mas relacionadas no contexto de redes Windows para compartilhamento de arquivos e recursos.

** Server Message Block (SMB)
- Protocolo principal para compartilhamento de arquivos e impressoras em redes Windows.
- Porta moderna: **TCP 445**.

** NetBIOS
- API e conjunto de protocolos para comunica√ß√£o em rede local, permitindo que aplica√ß√µes se encontrem e interajam.
- Atua como camada legada para o SMB em sistemas antigos.

* üõ†Ô∏è NetBIOS Services & Ports
- *Name Service (NetBIOS-NS):* Resolu√ß√£o de nomes. Porta **UDP 137**.
- *Datagram Service (NetBIOS-DGM):* Comunica√ß√£o sem conex√£o. Porta **UDP 138**.
- *Session Service (NetBIOS-SSN):* Comunica√ß√£o orientada a conex√£o. Porta **TCP 139**.

* üöÄ Practical Enumeration (Preview)
** üîç Basic Scanning
#+BEGIN_SRC bash
# Scan de rede para identificar nomes NetBIOS
sudo nbtscan -r 172.18.0.0/24

# Enumera√ß√£o detalhada com NetExec (nxc)
nxc smb 172.18.0.0/24 --shares -u 'guest' -p ''
#+END_SRC

* ‚öñÔ∏è GRC & Audit Perspective: Multi-Framework
Aqui est√° como a presen√ßa e configura√ß√£o do SMB/NetBIOS impactam diferentes normas:

** üìë NIST SP 800-53 (EUA/Federal)
- *CM-7 Least Functionality:* Recomenda desativar o NetBIOS (137-139) se o SMB direto (445) for suficiente, reduzindo a superf√≠cie de ataque.
- *SC-8 Transmission Confidentiality:* Exige prote√ß√£o dos dados em tr√¢nsito; sem SMB Signing ou criptografia, a conformidade falha.

** üåç ISO/IEC 27001 (Global/Corporativo)
- *A.8.9 Configuration Management:* Exige que sistemas sejam endurecidos (hardening). Manter protocolos legados (NetBIOS) sem justificativa de neg√≥cio √© uma n√£o-conformidade em auditorias ISO.
- *A.8.15 Logging:* A falta de logs de acesso a compartilhamentos SMB impede a conformidade com o controle de monitoramento de eventos.

** üõ°Ô∏è CIS Controls v8 (Defesa Ativa)
- *Control 4.1: Maintain Inventory of Assets:* O scan de SMB/NetBIOS √© frequentemente usado por defensores para validar o invent√°rio de m√°quinas Windows na rede.
- *Control 4.8: Uninstall or Disable Unnecessary Services:* O CIS prioriza a desativa√ß√£o do SMBv1 devido a vulnerabilidades cr√≠ticas como o EternalBlue.

** üáßüá∑ LGPD (Privacidade - Brasil)
- *Art. 46 (Seguran√ßa e Sigilo):* O acesso an√¥mino (Null Sessions) a compartilhamentos SMB que contenham Dados Pessoais √© uma viola√ß√£o grave, pois n√£o garante o controle de acesso e a rastreabilidade exigidos pela lei brasileira.

* üèÅ Conclusion
Dominar SMB e NetBIOS n√£o √© apenas sobre "invadir", mas sobre entender como as organiza√ß√µes devem proteger o fluxo de informa√ß√µes. Em um relat√≥rio profissional, voc√™ deve citar que a desativa√ß√£o de protocolos legados atende tanto √† **ISO 27001** quanto aos **CIS Controls**.
