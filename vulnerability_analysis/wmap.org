#+TITLE: Metasploit Web Auditing: WMAP Workflow
#+AUTHOR: gabriel
#+DATE: [2026-02-09 seg]
#+OPTIONS: toc:2

* üåê O que √© o WMAP?
O WMAP √© um scanner de vulnerabilidades web (DAST) derivado do antigo projeto SQLMap, integrado totalmente ao framework Metasploit. Ele utiliza a estrutura de m√≥dulos do MSF para testar vulnerabilidades como SQL Injection, Cross-Site Scripting (XSS) e falhas de configura√ß√£o de diret√≥rios.

* üõ†Ô∏è Configura√ß√£o Inicial
O WMAP depende obrigatoriamente do banco de dados do Metasploit para funcionar.

** 1. Inicializar Banco de Dados (Terminal Zsh)
#+BEGIN_SRC bash
sudo msfdb init
msfconsole -q
#+END_SRC

** 2. Carregar o Plugin
Dentro do =msfconsole=:
#+BEGIN_SRC msf
load wmap
#+END_SRC

* üöÄ Fluxo de Trabalho Pr√°tico
O WMAP segue uma sequ√™ncia l√≥gica: Site -> Alvo -> Scan.

** Passo 1: Definir o Site
O site √© a raiz do dom√≠nio que voc√™ deseja auditar.
#+BEGIN_SRC msf
# Adicionar o site
wmap_sites -a http://172.18.0.2

# Listar sites para confirmar
wmap_sites -l
#+END_SRC

** Passo 2: Definir o Alvo (Target)
O alvo √© a URL ou IP espec√≠fico onde os testes ser√£o realizados.
#+BEGIN_SRC msf
# Adicionar o alvo
wmap_targets -t http://172.18.0.2/index.php

# Listar alvos
wmap_targets -l
#+END_SRC

** Passo 3: Gerenciamento de M√≥dulos
Antes de rodar, o WMAP verifica quais m√≥dulos do Metasploit s√£o compat√≠veis com o alvo.
#+BEGIN_SRC msf
# Selecionar o alvo pelo ID (geralmente 0 se for o primeiro)
wmap_run -t
#+END_SRC

** Passo 4: Executar o Scan
Existem dois modos principais de execu√ß√£o:
#+BEGIN_SRC msf
# Executar apenas os m√≥dulos de teste/verifica√ß√£o
wmap_run -p

# Executar a auditoria completa (Explora√ß√£o de vulnerabilidades)
wmap_run -e
#+END_SRC

* üìä An√°lise de Resultados
Ap√≥s o t√©rmino do scan, voc√™ pode extrair as informa√ß√µes encontradas:

** Listar Vulnerabilidades
#+BEGIN_SRC msf
wmap_vulns -l
#+END_SRC

** Detalhes no Banco de Dados
Como os dados est√£o integrados ao MSF, voc√™ tamb√©m pode usar os comandos nativos:
#+BEGIN_SRC msf
vulns
notes
#+END_SRC

* üí° Comandos √öteis de Gerenciamento
- =wmap_sites -d [ID]= : Deleta um site espec√≠fico.
- =wmap_targets -d [ID]= : Deleta um alvo espec√≠fico.
- =wmap_run -h= : Exibe ajuda adicional sobre os par√¢metros de execu√ß√£o.

* üèÅ Dica de Pentester
O WMAP √© excelente para uma triagem r√°pida, mas ele pode ser barulhento nos logs do servidor web. Se voc√™ estiver em um laborat√≥rio da INE que exige furtividade, execute os m√≥dulos individualmente em vez de usar o =wmap_run -e=, que dispara todos os testes simultaneamente.
