#+title: Security Auditing And Pentesting

* üìò Intro
Para atuar com sucesso como um profissional de *Penetration Testing*, √© imperativo compreender quando, como e por que as auditorias de seguran√ßa s√£o realizadas e como elas se relacionam e afetam o teste de invas√£o.

Esta compreens√£o √© vital porque auditorias de seguran√ßa e *pentesting* s√£o dois tipos distintos de avalia√ß√µes, cada um com seu pr√≥prio escopo, objetivos e resultados desejados. Al√©m disso, √© importante entender a ordem sequencial em que s√£o executados ou se podem ser combinados em um √∫nico processo.

* ‚öñÔ∏è Security Audit x Penetration Testing
** Purpose
   - *Auditoria:* Verificar conformidade e ader√™ncia a pol√≠ticas/controles.
   - *Pentest:* Identificar e explorar vulnerabilidades para medir a resist√™ncia a ataques.
** Scope
   - *Auditoria:* Geralmente abrangente, cobrindo pol√≠ticas, processos e controles organizacionais.
   - *Pentest:* Focado em ativos espec√≠ficos, aplica√ß√µes ou infraestrutura de rede.
** Methodology
   - *Auditoria:* Baseada em checklists, entrevistas, revis√£o de documentos e inspe√ß√£o visual.
   - *Pentest:* Baseado em ataques simulados, explora√ß√£o ativa e t√©cnicas de hacking √©tico.
** Outcome
   - *Auditoria:* Relat√≥rio de conformidade (pass/fail) e lista de n√£o-conformidades.
   - *Pentest:* Relat√≥rio de vulnerabilidades explor√°veis e prova de conceito (PoC).
** Frequency
   - *Auditoria:* Geralmente anual ou conforme exig√™ncia regulat√≥ria.
   - *Pentest:* Idealmente cont√≠nuo ou ap√≥s mudan√ßas significativas na infraestrutura.

* üîÑ Sequential Approach
** Perform Security Audit First
   - Empresas geralmente realizam a auditoria primeiro para avaliar a postura geral, garantir conformidade regulat√≥ria e identificar melhorias em pol√≠ticas e procedimentos.
** Conduct Penetration Test Afterwards
   - Com base nos achados da auditoria, o pentest √© executado para validar se os controles t√©cnicos s√£o realmente eficazes na pr√°tica contra ataques reais.
** Combined Approach
   - Integra√ß√£o de ambos em um ciclo cont√≠nuo para garantir que a conformidade documental e a seguran√ßa t√©cnica caminhem juntas.

* üè¢ Sequential Approach Example
Cen√°rio da organiza√ß√£o fict√≠cia *"SecurePayments"*, que processa transa√ß√µes de cart√£o de cr√©dito e deve aderir ao padr√£o **PCI DSS**.

A organiza√ß√£o j√° realizou uma auditoria independente e est√° usando o relat√≥rio como base para seu plano de remedia√ß√£o. Voc√™ foi contratado para realizar o pentest focado em garantir a conformidade final.

*** Findings from Independent Audit:
    - Criptografia inadequada para dados de portadores de cart√£o em tr√¢nsito.
    - Controles de seguran√ßa de rede e monitoramento de tr√°fego fracos.
    - Pol√≠ticas de controle de acesso permissivas demais.
    - Procedimentos de resposta a incidentes desatualizados.

*** Recommendations:
    - Implementar protocolos de criptografia fortes (TLS 1.2+).
    - Revisar pol√≠ticas de acesso seguindo o *Princ√≠pio do Menor Privil√©gio*.
    - Atualizar e testar regularmente os planos de resposta a incidentes.

** üõ°Ô∏è Secure Payments - Penetration Test
*** Phase 1 - Planning and Preparation
    - Identifica√ß√£o do escopo PCI DSS (CDE - *Cardholder Data Environment*).
    - Revis√£o de diagramas de rede e question√°rios de autoavalia√ß√£o (SAQ).
    - Defini√ß√£o do cronograma e comunica√ß√£o com os *stakeholders*.
*** Phase 2 - Information Gathering and Reconnaissance
    - Coleta de pol√≠ticas de seguran√ßa e padr√µes de criptografia.
    - Revis√£o dos relat√≥rios de auditoria PCI DSS recentes para focar em √°reas cr√≠ticas.
*** Phase 3 - Penetration Test Execution
    - Varredura de rede, enumera√ß√£o e avalia√ß√£o de vulnerabilidades.
    - Tentativa de explora√ß√£o para validar o impacto real.
    - Teste de efic√°cia dos novos controles de criptografia e acesso implementados ap√≥s a auditoria.
*** Phase 4 - Findings and Recommendations
    - *Outcome:* O pentest descobriu novas falhas:
      - Interface administrativa exposta permitindo acesso n√£o autorizado.
      - Vulnerabilidades de SQL Injection em aplica√ß√µes voltadas ao cliente.
    - *Recommendations:*
      - Proteger a interface administrativa e aplicar patches contra SQLi.
      - Realizar uma revis√£o completa na seguran√ßa do ciclo de vida da aplica√ß√£o.
