#+title: Security Auditing With Lynis


* objective
perform a security audit on a linux server using lynis, identify vulnerabilities, and remediate the findings based on the security policy

*installing and running lynis*
- install lynis on the linux server
- audit the server with lynis scan on the target server
- analyze the lynis report to identify security issues

#+begin_src sh
sudo apt install lynis
#+end_src

#+begin_src sh
sudo lynis audit system
#+end_src


* ğŸ” Overview of Lynis
O Lynis Ã© uma ferramenta de auditoria de seguranÃ§a de cÃ³digo aberto para sistemas baseados em Unix (Linux, macOS, BSD). Ele Ã© amplamente utilizado para auditorias de conformidade (Compliance), endurecimento de sistemas (Hardening) e detecÃ§Ã£o de vulnerabilidades.

** Key Objectives
- *Vulnerability Scanning:* Identificar falhas de seguranÃ§a em software e configuraÃ§Ãµes.
- *Compliance Testing:* Verificar a aderÃªncia a frameworks como ISO 27001, NIST e CIS.
- *System Hardening:* Fornecer recomendaÃ§Ãµes especÃ­ficas para fortalecer as defesas do servidor.

* ğŸš€ Practical Usage: Running the Audit
Diferente de scanners de rede como o Nmap, o Lynis Ã© executado localmente para obter uma visÃ£o profunda do sistema operacional.

** Installation
No Debian/Kali (suas distros de uso frequente):
#+BEGIN_SRC bash
sudo apt update && sudo apt install lynis -y
#+END_SRC

** Performing a System Audit
O comando principal para uma auditoria completa:
#+BEGIN_SRC bash
lynis audit system
#+END_SRC

* ğŸ§ Lynis vs. Linux Security Policy (NIST 800-53)
O Lynis valida automaticamente os pontos que vocÃª definiu na sua polÃ­tica de servidores Linux:

** ğŸ”‘ Access Control (AC)
- *O que o Lynis checa:* Contas de usuÃ¡rio sem senha, arquivos =/etc/passwd= e =/etc/shadow=, e permissÃµes de arquivos crÃ­ticos.
- *Alinhamento:* Garante que apenas pessoal autorizado tenha acesso e que contas inativas sejam detectadas.

** ğŸ” Authentication (IA)
- *O que o Lynis checa:* ConfiguraÃ§Ãµes do serviÃ§o SSH (=sshd_config=), verificaÃ§Ã£o de uso de chaves pÃºblicas e proibiÃ§Ã£o de login root via senha.
- *Alinhamento:* Valida se o acesso SSH por senha estÃ¡ desativado conforme sua polÃ­tica.

** ğŸ“ Audit and Accountability (AU)
- *O que o Lynis checa:* PresenÃ§a e status do =rsyslog= ou =journald=, e se o daemon de auditoria (=auditd=) estÃ¡ configurado.
- *Alinhamento:* Confirma se os logs crÃ­ticos estÃ£o sendo capturados e centralizados.

* ğŸ“Š Interpreting the Results
Ao final da execuÃ§Ã£o, o Lynis fornece dois indicadores cruciais:

** Hardening Index
- Uma pontuaÃ§Ã£o numÃ©rica que indica o quÃ£o seguro o servidor estÃ¡.
- Ãštil para relatÃ³rios de GRC para demonstrar a evoluÃ§Ã£o da seguranÃ§a ao longo do tempo.

** Suggestions and Warnings
- *Warnings:* Problemas crÃ­ticos que devem ser corrigidos imediatamente (ex: vulnerabilidades conhecidas).
- *Suggestions:* RecomendaÃ§Ãµes de melhoria (ex: habilitar firewall UFW, que vocÃª jÃ¡ utiliza em seus labs).

* ğŸ’¡ Integration with Pentesting
Como analista de seguranÃ§a, vocÃª pode usar os relatÃ³rios do Lynis localizados em =/var/log/lynis.log= para encontrar vetores de escalaÃ§Ã£o de privilÃ©gios que passariam despercebidos em um scan manual.

** Example Finding
Se o Lynis indicar um "Warning" sobre permissÃµes SUID em binÃ¡rios incomuns, este Ã© um alvo imediato para sua fase de exploraÃ§Ã£o tÃ©cnica.
